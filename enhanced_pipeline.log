2025-11-27 09:57:13,563 - __main__ - INFO - ================================================================================
2025-11-27 09:57:13,563 - __main__ - INFO - ENHANCED KALMAN FILTER PIPELINE
2025-11-27 09:57:13,563 - __main__ - INFO - ================================================================================
2025-11-27 09:57:13,564 - __main__ - INFO - 
================================================================================
2025-11-27 09:57:13,564 - __main__ - INFO - Processing GEO Satellite
2025-11-27 09:57:13,564 - __main__ - INFO - ================================================================================
2025-11-27 09:57:13,567 - __main__ - INFO - Step 1: Ensuring preprocessed data exists...
2025-11-27 09:57:13,567 - __main__ - INFO - Using existing preprocessed data: temp\GEO_01_timeseries.parquet
2025-11-27 09:57:13,569 - __main__ - INFO - Step 2: Training enhanced filter for GEO...
2025-11-27 09:57:13,640 - src.train_enhanced - INFO - GEO: 361 real measurements out of 648
2025-11-27 09:57:13,641 - src.train_enhanced - INFO - Training enhanced filter for GEO...
2025-11-27 09:57:13,642 - src.train_enhanced - INFO - Training on 288 samples, validating on 73 samples
2025-11-27 09:57:13,643 - __main__ - ERROR - Error processing GEO: 'Sat_Clock_Error'
Traceback (most recent call last):
  File "C:\Users\saiph\AppData\Roaming\Python\Python311\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Sat_Clock_Error'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\saiph\Desktop\sih-isro\sih-2025-Isro\run_enhanced.py", line 81, in main
    result = train_and_predict_enhanced(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saiph\Desktop\sih-isro\sih-2025-Isro\src\train_enhanced.py", line 203, in train_and_predict_enhanced
    kf, metrics = train_enhanced_filter(df_real, dt=dt, validation_split=0.2)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saiph\Desktop\sih-isro\sih-2025-Isro\src\train_enhanced.py", line 61, in train_enhanced_filter
    row['Sat_Clock_Error']
    ~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saiph\AppData\Roaming\Python\Python311\site-packages\pandas\core\series.py", line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saiph\AppData\Roaming\Python\Python311\site-packages\pandas\core\series.py", line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saiph\AppData\Roaming\Python\Python311\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Sat_Clock_Error'
2025-11-27 09:57:13,649 - __main__ - INFO - 
================================================================================
2025-11-27 09:57:13,649 - __main__ - INFO - PIPELINE COMPLETE
2025-11-27 09:57:13,649 - __main__ - INFO - ================================================================================
2025-11-27 09:58:10,755 - __main__ - INFO - ================================================================================
2025-11-27 09:58:10,756 - __main__ - INFO - ENHANCED KALMAN FILTER PIPELINE
2025-11-27 09:58:10,757 - __main__ - INFO - ================================================================================
2025-11-27 09:58:10,757 - __main__ - INFO - 
================================================================================
2025-11-27 09:58:10,757 - __main__ - INFO - Processing GEO Satellite
2025-11-27 09:58:10,758 - __main__ - INFO - ================================================================================
2025-11-27 09:58:10,758 - __main__ - INFO - Step 1: Ensuring preprocessed data exists...
2025-11-27 09:58:10,758 - __main__ - INFO - Using existing preprocessed data: temp\GEO_01_timeseries.parquet
2025-11-27 09:58:10,758 - __main__ - INFO - Step 2: Training enhanced filter for GEO...
2025-11-27 09:58:10,820 - src.train_enhanced - INFO - GEO: 361 real measurements out of 648
2025-11-27 09:58:10,821 - src.train_enhanced - INFO - Training enhanced filter for GEO...
2025-11-27 09:58:10,821 - src.train_enhanced - INFO - Training on 288 samples, validating on 73 samples
2025-11-27 09:58:11,756 - src.train_enhanced - WARNING - Grid search failed, using default parameters
2025-11-27 09:58:11,820 - src.train_enhanced - INFO - Best parameters: Q=1.00, R=1.00, MAE=infm
2025-11-27 09:58:11,821 - src.train_enhanced - INFO - Forecasting Day 8 for GEO...
2025-11-27 09:58:11,833 - src.train_enhanced - INFO - Predictions saved to outputs\predictions_day8_geo_enhanced.csv
2025-11-27 09:58:11,834 - src.train_enhanced - INFO - Model saved to outputs\kf_model_geo_enhanced.pkl
2025-11-27 09:58:11,834 - __main__ - INFO - 
GEO Results:
2025-11-27 09:58:11,834 - __main__ - INFO -   Training MAE: infm
2025-11-27 09:58:11,835 - __main__ - INFO -   Best Q scale: 1.00
2025-11-27 09:58:11,835 - __main__ - INFO -   Best R scale: 1.00
2025-11-27 09:58:11,835 - __main__ - INFO - 
  Prediction Statistics:
2025-11-27 09:58:11,835 - __main__ - INFO -     X: nan ± nanm, range=[nan, nan]
2025-11-27 09:58:11,835 - __main__ - INFO -     Y: nan ± nanm, range=[nan, nan]
2025-11-27 09:58:11,835 - __main__ - INFO -     Z: nan ± nanm, range=[nan, nan]
2025-11-27 09:58:11,835 - __main__ - INFO - 
  Files saved:
2025-11-27 09:58:11,835 - __main__ - INFO -     Predictions: outputs\predictions_day8_geo_enhanced.csv
2025-11-27 09:58:11,835 - __main__ - INFO -     Model: outputs\kf_model_geo_enhanced.pkl
2025-11-27 09:58:11,836 - __main__ - INFO - 
================================================================================
2025-11-27 09:58:11,836 - __main__ - INFO - PIPELINE COMPLETE
2025-11-27 09:58:11,836 - __main__ - INFO - ================================================================================
